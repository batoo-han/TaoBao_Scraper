# ๐ฆ ะะฝัะตะณัะฐัะธั Pinduoduo

## ะะฑะทะพั

ะะพั ัะตะฟะตัั ะฟะพะดะดะตัะถะธะฒะฐะตั ะฟะฐััะธะฝะณ ัะพะฒะฐัะพะฒ ั ะฟะปะฐััะพัะผั **Pinduoduo (ๆผๅคๅค)** ะฒ ะดะพะฟะพะปะฝะตะฝะธะต ะบ Taobao ะธ Tmall.

### ะะปััะตะฒัะต ะฒะพะทะผะพะถะฝะพััะธ

โ **ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ะฟะปะฐััะพัะผั** - ะฑะพั ัะฐะผ ะฟะพะฝะธะผะฐะตั, ั ะบะฐะบะพะน ะฟะปะฐััะพัะผั ัััะปะบะฐ  
โ **Rate Limiting** - ะบะพะฝััะพะปั ัะฐััะพัั ะทะฐะฟัะพัะพะฒ ะบ API (ะฟะพ ัะผะพะปัะฐะฝะธั 5 ะทะฐะฟัะพัะพะฒ/ัะตะบ)  
โ **ะฃะฝะธัะธัะธัะพะฒะฐะฝะฝัะน API** - ะพะดะธะฝ ะผะตัะพะด ะดะปั ะฒัะตั ะฟะปะฐััะพัะผ  
โ **ะะพะดะดะตัะถะบะฐ Pinduoduo URL** - yangkeduo.com, pinduoduo.com, mobile.yangkeduo.com  

---

## ะััะธัะตะบัััะฐ

### ะะพะผะฟะพะฝะตะฝัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         url_parser.py                   โ
โ  - ะะฟัะตะดะตะปะตะฝะธะต ะฟะปะฐััะพัะผั                โ
โ  - ะะทะฒะปะตัะตะฝะธะต item_id                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         tmapi.py                        โ
โ  - get_product_info_auto()              โ
โ  - get_pinduoduo_product()              โ
โ  - Rate limiting                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         scraper.py                      โ
โ  - ะะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั Pinduoduo           โ
โ  - ะะดะฐะฟัะฐัะธั ััััะบัััั                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         bot_handler.py                  โ
โ  - ะะฑัะฐะฑะพัะบะฐ Pinduoduo URLs             โ
โ  - ะัะฟัะฐะฒะบะฐ ัะตะทัะปััะฐัะฐ                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ะะฐัััะพะนะบะฐ

### 1. ะะพะปััะตะฝะธะต API ัะพะบะตะฝะฐ ะดะปั Pinduoduo

1. ะะฐะนะดะธัะต ะฝะฐ [https://tmapi.top](https://tmapi.top)
2. ะะพะนะดะธัะต ะฒ ะฐะบะบะฐัะฝั (ะธะปะธ ะทะฐัะตะณะธัััะธััะนัะตัั)
3. ะะพะปััะธัะต **ะพัะดะตะปัะฝัะน ัะพะบะตะฝ** ะดะปั Pinduoduo API
4. ะกะบะพะฟะธััะนัะต ัะพะบะตะฝ

### 2. ะะฑะฝะพะฒะปะตะฝะธะต `.env`

ะะพะฑะฐะฒััะต ะฝะพะฒัะต ะฟะตัะตะผะตะฝะฝัะต ะฒ `.env`:

```env
# ะขะพะบะตะฝ ะดะปั Taobao/Tmall
TMAPI_TOKEN=your_taobao_token_here

# ะขะพะบะตะฝ ะดะปั Pinduoduo (ะะะะะ: ะฟะพะปััะธัะต ะพัะดะตะปัะฝัะน!)
TMAPI_PINDUODUO_TOKEN=your_pinduoduo_token_here

# ะะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ะทะฐะฟัะพัะพะฒ ะฒ ัะตะบัะฝะดั (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะฟะพ ัะผะพะปัะฐะฝะธั 5)
TMAPI_RATE_LIMIT=5
```

โ๏ธ **ะะฐะถะฝะพ:** ะขะพะบะตะฝั ะดะปั Taobao/Tmall ะธ Pinduoduo **ัะฐะทะฝัะต**!

---

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะพะดะดะตัะถะธะฒะฐะตะผัะต URL ัะพัะผะฐัั

ะะพั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะฐัะฟะพะทะฝะฐัั ัะปะตะดัััะธะต ัะพัะผะฐัั Pinduoduo:

```
https://mobile.yangkeduo.com/goods.html?goods_id=123456789
https://yangkeduo.com/goods.html?goods_id=123456789
https://pinduoduo.com/goods.html?goods_id=123456789
https://pdd.com/goods.html?goods_id=123456789
```

### ะัะธะผะตัั

#### ะัะฟัะฐะฒะบะฐ ัััะปะบะธ ะฑะพัั:

```
ะะพะปัะทะพะฒะฐัะตะปั: https://mobile.yangkeduo.com/goods.html?goods_id=99215544343
ะะพั: [ะะฑัะฐะฑะฐััะฒะฐะตั ัะพะฒะฐั ั Pinduoduo ะธ ะพัะฟัะฐะฒะปัะตั ะฟะพัั ั ัะพัะพ]
```

#### ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ะฟะปะฐััะพัะผั:

```python
from url_parser import URLParser, Platform

url = "https://mobile.yangkeduo.com/goods.html?goods_id=123456"
platform, item_id = URLParser.parse_url(url)

print(platform)  # Output: "pinduoduo"
print(item_id)   # Output: "123456"
```

---

## ะะฐะทะปะธัะธั ะผะตะถะดั ะฟะปะฐััะพัะผะฐะผะธ

| ะะฐัะฐะผะตัั | Taobao/Tmall | Pinduoduo |
|----------|--------------|-----------|
| **API Endpoint** | `/taobao/item_detail_by_url` | `/pdd/item_detail` |
| **ะัะพะดะฝะพะน ะฟะฐัะฐะผะตัั** | URL (ะฟะพะปะฝัะน) | `item_id` (ัะพะปัะบะพ ID) |
| **ะขะพะบะตะฝ** | `TMAPI_TOKEN` | `TMAPI_PINDUODUO_TOKEN` |
| **ะะทะพะฑัะฐะถะตะฝะธั** | `main_imgs` + `sku_props` | `main_imgs` + `detail_imgs` |
| **SKU ััััะบัััะฐ** | `sku_props` (ะผะฐััะธะฒ ะพะฑัะตะบัะพะฒ) | `skus` (props_names ะฒ ัััะพะบะต) |
| **ะฆะตะฝะฐ** | `price` (ัััะพะบะฐ) | `price_info` (ะพะฑัะตะบั) |
| **ะะตัะฐะปัะฝัะต ะธะทะพะฑัะฐะถะตะฝะธั** | ะัะพัะพะน ะทะฐะฟัะพั ะบ `/item_desc` | ะ ะพัะฝะพะฒะฝะพะผ ะพัะฒะตัะต |

---

## ะกัััะบัััะฐ ะดะฐะฝะฝัั Pinduoduo

### ะัะฝะพะฒะฝะพะน ะพัะฒะตั API

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "item_id": 99215544343,
    "title": "ะะฐะทะฒะฐะฝะธะต ัะพะฒะฐัะฐ",
    "price": 211.5,
    "price_info": {
      "price": "211.5",
      "min_onsale_group_price": "211.5",
      "max_onsale_group_price": "312.7"
    },
    "product_props": [
      {"key": "ๅ็", "values": ["่ดจ้"]},
      {"key": "็ตๆบๆนๅผ", "values": ["ไบคๆต็ต"]}
    ],
    "main_imgs": [
      "https://img.pddpic.com/..."
    ],
    "detail_imgs": [
      "https://img.pddpic.com/..."
    ],
    "skus": [
      {
        "skuid": 1474323993683,
        "sale_price": "211.5",
        "props_names": "ๅๅท:็ปๆตๆฌพ;ๅฅ้ค:็คผๅไธ",
        "stock": 100
      }
    ]
  }
}
```

### ะะทะฒะปะตัะตะฝะธะต ะฒะฐัะธะฐะฝัะพะฒ ัะพะฒะฐัะฐ

ะะปั Pinduoduo ะฒะฐัะธะฐะฝัั (ัะฒะตัะฐ, ัะฐะทะผะตัั) ััะฐะฝัััั ะฒ `skus`:

```python
# ะคะพัะผะฐั props_names: "ๅๅท:็ปๆตๆฌพ;ๅฅ้ค:็คผๅไธ"
# ะะฐััะธะฝะณ:
for sku in skus:
    props_names = sku['props_names']  # "ๅๅท:็ปๆตๆฌพ;ๅฅ้ค:็คผๅไธ"
    props_parts = props_names.split(';')  # ["ๅๅท:็ปๆตๆฌพ", "ๅฅ้ค:็คผๅไธ"]
    
    for part in props_parts:
        key, value = part.split(':', 1)  # "ๅๅท", "็ปๆตๆฌพ"
        # key - ะฝะฐะทะฒะฐะฝะธะต ัะฒะพะนััะฒะฐ (ๅๅท = ะผะพะดะตะปั)
        # value - ะทะฝะฐัะตะฝะธะต (็ปๆตๆฌพ = ัะบะพะฝะพะผ)
```

---

## Rate Limiting

### ะะฐัััะพะนะบะฐ

ะะณัะฐะฝะธัะตะฝะธะต ัะฐััะพัั ะทะฐะฟัะพัะพะฒ ะฝะฐัััะฐะธะฒะฐะตััั ัะตัะตะท `.env`:

```env
# ะะฐะบัะธะผัะผ 5 ะทะฐะฟัะพัะพะฒ ะฒ ัะตะบัะฝะดั (ะฟะพ ัะผะพะปัะฐะฝะธั)
TMAPI_RATE_LIMIT=5

# ะะปั ะฑะพะปะตะต ะผะตะดะปะตะฝะฝะพะน ัะฐะฑะพัั:
TMAPI_RATE_LIMIT=2

# ะะปั ะฑะพะปะตะต ะฑััััะพะน (ะตัะปะธ API ะฟะพะทะฒะพะปัะตั):
TMAPI_RATE_LIMIT=10
```

### ะะฐะบ ัะฐะฑะพัะฐะตั

1. ะะตัะตะด ะบะฐะถะดัะผ ะทะฐะฟัะพัะพะผ ะฑะพั ะฟัะพะฒะตััะตั ะฒัะตะผั ั ะฟะพัะปะตะดะฝะตะณะพ ะทะฐะฟัะพัะฐ
2. ะัะปะธ ะฟัะพัะปะพ ะผะตะฝััะต `1/TMAPI_RATE_LIMIT` ัะตะบัะฝะด - ะถะดัั
3. ะะฐัะตะผ ะฒัะฟะพะปะฝัะตั ะทะฐะฟัะพั
4. ะกะพััะฐะฝัะตั ะฒัะตะผั ะทะฐะฟัะพัะฐ

**ะัะธะผะตั:**
```
TMAPI_RATE_LIMIT=5 โ ะผะธะฝะธะผัะผ 200ms ะผะตะถะดั ะทะฐะฟัะพัะฐะผะธ
TMAPI_RATE_LIMIT=2 โ ะผะธะฝะธะผัะผ 500ms ะผะตะถะดั ะทะฐะฟัะพัะฐะผะธ
```

---

## ะัะปะฐะดะบะฐ

### ะะบะปััะตะฝะธะต DEBUG ะปะพะณะพะฒ

```env
DEBUG_MODE=True
```

### ะัะธะผะตัั ะปะพะณะพะฒ

```
[TMAPI] ๐ ะะฟัะตะดะตะปะตะฝะฐ ะฟะปะฐััะพัะผะฐ: pinduoduo
[TMAPI] ๐ ะะทะฒะปะตััะฝ item_id: 99215544343
[TMAPI] โฑ๏ธ  Rate limiting: ะถะดัะผ 0.150 ัะตะบ
[TMAPI] GET http://api.tmapi.top/pdd/item_detail
[TMAPI] ะะฐัะฐะผะตััั: item_id=99215544343
[TMAPI] ะกัะฐััั ะพัะฒะตัะฐ: 200
[Scraper] ะะปะฐััะพัะผะฐ: pinduoduo
[Scraper] Pinduoduo: main_imgs=10, detail_imgs=16
```

---

## ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

### ะะตะฟะพะดะดะตัะถะธะฒะฐะตะผะฐั ะฟะปะฐััะพัะผะฐ

```python
try:
    result = await tmapi_client.get_product_info_auto(url)
except ValueError as e:
    # ะัะธะฑะบะฐ: "ะะตะฟะพะดะดะตัะถะธะฒะฐะตะผะฐั ะฟะปะฐััะพัะผะฐ: http://example.com"
    print(e)
```

### ะะต ัะดะฐะปะพัั ะธะทะฒะปะตัั item_id

```python
try:
    result = await tmapi_client.get_pinduoduo_product(url)
except ValueError as e:
    # ะัะธะฑะบะฐ: "ะะต ัะดะฐะปะพัั ะธะทะฒะปะตัั item_id ะธะท URL Pinduoduo"
    print(e)
```

### HTTP ะพัะธะฑะบะธ

```python
import httpx

try:
    result = await tmapi_client.get_product_info_auto(url)
except httpx.HTTPStatusError as e:
    # ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ API (401, 403, 500 ะธ ั.ะด.)
    print(f"HTTP {e.response.status_code}: {e.response.text}")
```

---

## ะขะตััะธัะพะฒะฐะฝะธะต

### Mock ัะตะถะธะผ

ะะปั ัะตััะธัะพะฒะฐะฝะธั ะฑะตะท ัะตะฐะปัะฝัั API ะทะฐะฟัะพัะพะฒ:

```env
MOCK_MODE=True
DEBUG_MODE=True
```

ะ Mock ัะตะถะธะผะต Pinduoduo ะฒะพะทะฒัะฐัะฐะตั ะทะฐะณะปััะบั:

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "item_id": 123456,
    "title": "[MOCK] Pinduoduo ัะพะฒะฐั",
    "price": 100.0
  }
}
```

### ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต

```python
from tmapi import TmapiClient

client = TmapiClient()

# ะขะตัั 1: ะะฟัะตะดะตะปะตะฝะธะต ะฟะปะฐััะพัะผั
url = "https://mobile.yangkeduo.com/goods.html?goods_id=99215544343"
result = await client.get_product_info_auto(url)
print(result['_platform'])  # "pinduoduo"

# ะขะตัั 2: ะะทะฒะปะตัะตะฝะธะต item_id
from url_parser import URLParser
platform, item_id = URLParser.parse_url(url)
print(item_id)  # "99215544343"
```

---

## ะะณัะฐะฝะธัะตะฝะธั

โ๏ธ **TMAPI ะพะณัะฐะฝะธัะตะฝะธั:**
- ะผะฐะบัะธะผัะผ 5 ะทะฐะฟัะพัะพะฒ/ัะตะบ (ะฟะพ ัะผะพะปัะฐะฝะธั)
- ะผะพะถะตั ะธะทะผะตะฝะธัััั ะฒ ะฑัะดััะตะผ (ะฝะฐัััะฐะธะฒะฐะตััั ัะตัะตะท `TMAPI_RATE_LIMIT`)

โ๏ธ **Pinduoduo ะพัะพะฑะตะฝะฝะพััะธ:**
- id ัะพะฒะฐัะฐ ะดะพะปะถะตะฝ ะฑััั ะฒ ะฟะฐัะฐะผะตััะฐั URL (`goods_id`, `id`, `item_id`)
- ะตัะปะธ ID ะฝะต ะฝะฐะนะดะตะฝ - ะพัะธะฑะบะฐ `ValueError`

---

## FAQ

### Q: ะัะถะตะฝ ะปะธ ะพัะดะตะปัะฝัะน ัะพะบะตะฝ ะดะปั Pinduoduo?
**A:** ะะฐ, ัะพะบะตะฝั ะดะปั Taobao/Tmall ะธ Pinduoduo **ัะฐะทะฝัะต**. ะะพะปััะธัะต ะพะฑะฐ ะฝะฐ tmapi.top.

### Q: ะะฐะบ ะธะทะผะตะฝะธัั ะปะธะผะธั ะทะฐะฟัะพัะพะฒ?
**A:** ะะทะผะตะฝะธัะต `TMAPI_RATE_LIMIT` ะฒ `.env` (ะฝะฐะฟัะธะผะตั, `TMAPI_RATE_LIMIT=10`).

### Q: ะะพัะตะผั ะฑะพั ะฝะต ะฟะฐััะธั Pinduoduo?
**A:** ะัะพะฒะตัััะต:
1. ะะพะฑะฐะฒะปะตะฝ ะปะธ `TMAPI_PINDUODUO_TOKEN` ะฒ `.env`?
2. ะัะฐะฒะธะปัะฝัะน ะปะธ ัะพัะผะฐั URL (ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั `goods_id`)?
3. ะะบะปัััะฝ ะปะธ `DEBUG_MODE` ะดะปั ะฟัะพัะผะพััะฐ ะปะพะณะพะฒ?

### Q: ะะฐะบ ัะทะฝะฐัั item_id ะธะท Pinduoduo URL?
**A:** ะัะบัะพะนัะต URL ะฒ ะฑัะฐัะทะตัะต, item_id ะพะฑััะฝะพ ะฒ ะฟะฐัะฐะผะตััะต `goods_id`:
```
https://mobile.yangkeduo.com/goods.html?goods_id=99215544343
                                                 โ ััะพ item_id
```

---

## Roadmap

๐ **ะะปะฐะฝะธััะตััั:**
- [ ] ะฟะพะดะดะตัะถะบะฐ ะดััะณะธั ะบะธัะฐะนัะบะธั ะฟะปะฐััะพัะผ (JD.com, 1688.com)
- [ ] ะฐะฒัะพะผะฐัะธัะตัะบะฐั ะบะพััะตะบัะธั ะฝะตะฟะพะปะฝัั URL
- [ ] ะบััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะดะปั ะพะดะธะฝะฐะบะพะฒัั ัะพะฒะฐัะพะฒ
- [ ] batch API ะทะฐะฟัะพัั (ะฝะตัะบะพะปัะบะพ ัะพะฒะฐัะพะฒ ะทะฐ ัะฐะท)

---

## ะะพะดะดะตัะถะบะฐ

ะัะปะธ ะฒะพะทะฝะธะบะปะธ ะฟัะพะฑะปะตะผั:
1. ะัะพะฒะตัััะต ะปะพะณะธ (`DEBUG_MODE=True`)
2. ะฃะฑะตะดะธัะตัั ััะพ ัะพะบะตะฝั ะฟัะฐะฒะธะปัะฝัะต
3. ะัะพะฒะตัััะต ัะพัะผะฐั URL
4. ะัะบัะพะนัะต issue ะฝะฐ GitHub
