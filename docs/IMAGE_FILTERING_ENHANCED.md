# –£—Å–∏–ª–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ `detail_html`, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç—Å–µ–∏–≤–∞–µ—Ç:
- –ò–∫–æ–Ω–∫–∏ –∏ –∫–Ω–æ–ø–∫–∏ (–º–∞–ª–µ–Ω—å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- –°–ª–∏—à–∫–æ–º –ª—ë–≥–∫–∏–µ —Ñ–∞–π–ª—ã
- –ë–∞–Ω–Ω–µ—Ä—ã (—Å–∏–ª—å–Ω–æ –≤—ã—Ç—è–Ω—É—Ç—ã–µ)
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –æ—Ç–ª–∏—á–∞—é—â–∏–µ—Å—è –ø–æ –ø–ª–æ—â–∞–¥–∏
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º —Å—Ç–æ—Ä–æ–Ω

## üîç –≠—Ç–∞–ø—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä (400√ó400)
```python
min_dimension = 400  # –ø–∏–∫—Å–µ–ª–µ–π
```

**–û—Ç—Å–µ–∏–≤–∞–µ—Ç:**
- –ò–∫–æ–Ω–∫–∏ (24√ó24, 48√ó48)
- –ö–Ω–æ–ø–∫–∏ (100√ó50, 200√ó100)
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**–ü—Ä–∏–º–µ—Ä:**
- ‚ùå 200√ó200 ‚Üí –æ—Ç—Å–µ—è–Ω
- ‚úÖ 500√ó600 ‚Üí –ø—Ä–æ–π–¥—ë—Ç

---

### –®–∞–≥ 2: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å (20 KB)
```python
min_file_size = 20 * 1024  # –±–∞–π—Ç
```

**–û—Ç—Å–µ–∏–≤–∞–µ—Ç:**
- –ò–∫–æ–Ω–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- –ú–∞–ª–µ–Ω—å–∫–∏–µ PNG/SVG —ç–ª–µ–º–µ–Ω—Ç—ã
- –õ–æ–≥–æ—Ç–∏–ø—ã

**–ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä:**
- –ò–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Range` –ø—Ä–∏ Range-–∑–∞–ø—Ä–æ—Å–µ
- –§–æ—Ä–º–∞—Ç: `bytes 0-4095/153600` ‚Üí –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä = 153600 –±–∞–π—Ç (150 KB)
- –ï—Å–ª–∏ `Content-Range` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí —Ñ–∏–ª—å—Ç—Ä **–Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è** (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç)

**–ü—Ä–∏–º–µ—Ä:**
- ‚ùå 350√ó350 (15 KB) ‚Üí –æ—Ç—Å–µ—è–Ω
- ‚úÖ 800√ó800 (120 KB) ‚Üí –ø—Ä–æ–π–¥—ë—Ç
- ‚úÖ 500√ó500 (—Ä–∞–∑–º–µ—Ä –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω) ‚Üí –ø—Ä–æ–π–¥—ë—Ç

---

### –®–∞–≥ 3: –ë–∞–Ω–Ω–µ—Ä—ã (aspect ratio > 5:1)
```python
0.2 <= aspect_ratio <= 5.0
```

**–û—Ç—Å–µ–∏–≤–∞–µ—Ç:**
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –±–∞–Ω–Ω–µ—Ä—ã (2480√ó184)
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –≤—ã—Ç—è–Ω—É—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

**–ü—Ä–∏–º–µ—Ä:**
- ‚ùå 2480√ó184 (aspect 13.5) ‚Üí –æ—Ç—Å–µ—è–Ω
- ‚úÖ 1500√ó600 (aspect 2.5) ‚Üí –ø—Ä–æ–π–¥—ë—Ç

---

### –®–∞–≥ 4: –ü–ª–æ—â–∞–¥—å (0.6√ó‚Äì1.7√ó –æ—Ç –º–µ–¥–∏–∞–Ω—ã)
```python
median_area = statistics.median(areas)
acceptable_range = 0.6 to 1.7
```

**–û—Ç—Å–µ–∏–≤–∞–µ—Ç:**
- –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
–ú–µ–¥–∏–∞–Ω–∞: 2,925,000 –ø–∏–∫—Å–µ–ª–µ–π (1500√ó1950)

| –†–∞–∑–º–µ—Ä | –ü–ª–æ—â–∞–¥—å | Ratio | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|---------|-------|-----------|
| 1500√ó1950 | 2,925,000 | 1.00 | ‚úÖ –ü—Ä–æ–π–¥—ë—Ç |
| 1500√ó1854 | 2,781,000 | 0.95 | ‚úÖ –ü—Ä–æ–π–¥—ë—Ç |
| 2479√ó1007 | 2,496,253 | 0.85 | ‚úÖ –ü—Ä–æ–π–¥—ë—Ç (–Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ) |
| 800√ó600 | 480,000 | 0.16 | ‚ùå –û—Ç—Å–µ—è–Ω |

---

### –®–∞–≥ 5: Aspect Ratio (¬±40% –æ—Ç –º–µ–¥–∏–∞–Ω—ã)
```python
median_aspect = statistics.median(aspect_ratios)
min_aspect = median_aspect * 0.6
max_aspect = median_aspect * 1.4
```

**–û—Ç—Å–µ–∏–≤–∞–µ—Ç:**
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ä–µ–¥–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ä–µ–¥–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä:**
–ú–µ–¥–∏–∞–Ω–∞ aspect: 0.77 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ 1500√ó1950)

–î–æ–ø—É—Å—Ç–∏–º–æ: 0.46‚Äì1.08

| –†–∞–∑–º–µ—Ä | Aspect | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|--------|-----------|
| 1500√ó1950 | 0.77 | ‚úÖ –ü—Ä–æ–π–¥—ë—Ç |
| 1500√ó1854 | 0.81 | ‚úÖ –ü—Ä–æ–π–¥—ë—Ç |
| **2479√ó1007** | **2.46** | **‚ùå –û—Ç—Å–µ—è–Ω!** |

---

## üìä –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
38 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ API detail_html
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞
```
38 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
 ‚Üì [–®–∞–≥ 1] –ú–∏–Ω–∏–º—É–º 400√ó400
32 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ—Ç—Å–µ—è–Ω–æ 6 –º–∞–ª–µ–Ω—å–∫–∏—Ö)
 ‚Üì [–®–∞–≥ 2] –ú–∏–Ω–∏–º—É–º 20 KB
30 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ç—Å–µ—è–Ω–æ 2 –ª—ë–≥–∫–∏—Ö)
 ‚Üì [–®–∞–≥ 3] –ë–∞–Ω–Ω–µ—Ä—ã (aspect > 5)
28 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ç—Å–µ—è–Ω–æ 2 –±–∞–Ω–Ω–µ—Ä–∞)
 ‚Üì [–®–∞–≥ 4] –ü–ª–æ—â–∞–¥—å (0.6√ó‚Äì1.7√ó)
28 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤—Å—ë –ø—Ä–æ—à–ª–æ)
 ‚Üì [–®–∞–≥ 5] Aspect ratio (¬±40%)
25 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ç—Å–µ—è–Ω–æ 3 –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö)
```

### –ò—Ç–æ–≥
```
‚úÖ 25 –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚ùå 13 –æ—Ç—Å–µ—è–Ω–æ (–∏–∫–æ–Ω–∫–∏, –±–∞–Ω–Ω–µ—Ä—ã, –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
```

---

## üß™ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏ `DEBUG_MODE=True` –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
[Scraper] –ù–∞–π–¥–µ–Ω–æ 38 —Ç–µ–≥–æ–≤ <img> –≤ HTML
[Scraper] ‚úÖ Range –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–µ–Ω: 1500√ó1950, –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä: ~145.3KB
[Scraper] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–æ–µ: 200√ó200 (–º–∏–Ω–∏–º—É–º 400√ó400)
[Scraper] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–∏—à–∫–æ–º –ª—ë–≥–∫–æ–µ: 350√ó350 (15.2KB < 20KB)
[Scraper] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –±–∞–Ω–Ω–µ—Ä: 2480√ó184 (aspect: 13.48)
[Scraper] –ú–µ–¥–∏–∞–Ω–Ω–∞—è –ø–ª–æ—â–∞–¥—å: 2,925,000 –ø–∏–∫—Å–µ–ª–µ–π
[Scraper] –ú–µ–¥–∏–∞–Ω–Ω—ã–π aspect ratio: 0.77
[Scraper] –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 2479√ó1007 (aspect 2.46 –Ω–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.46-1.08)
[Scraper] ‚úÖ –ü—Ä–æ—à–ª–∏ —Ñ–∏–ª—å—Ç—Ä: 1500√ó1950, 1500√ó1950, 1500√ó1950, 1500√ó1950, 1500√ó1854
[Scraper] Detail –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 38 ‚Üí 25 –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
```

---

## üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–æ—Ä–æ–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
```python
min_dimension = 400  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤ scraper.py, —Å—Ç—Ä–æ–∫–∞ ~478
```

### –ü–æ—Ä–æ–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤–µ—Å–∞
```python
min_file_size = 20 * 1024  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤ scraper.py, —Å—Ç—Ä–æ–∫–∞ ~496
```

### –î–æ–ø—É—Å–∫ –ø–æ –ø–ª–æ—â–∞–¥–∏
```python
if 0.6 <= ratio <= 1.7:  # –ò–∑–º–µ–Ω–∏—Ç–µ –≤ scraper.py, —Å—Ç—Ä–æ–∫–∞ ~555
```

### –î–æ–ø—É—Å–∫ –ø–æ aspect ratio
```python
min_aspect = median_aspect * 0.6  # –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤ scraper.py, —Å—Ç—Ä–æ–∫–∞ ~579
max_aspect = median_aspect * 1.4  # –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤ scraper.py, —Å—Ç—Ä–æ–∫–∞ ~580
```

---

## üìö –°–º. —Ç–∞–∫–∂–µ

- [IMAGE_SIZE_DETECTION.md](IMAGE_SIZE_DETECTION.md) ‚Äî –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ä–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [DETAIL_IMAGES_FILTERING.md](DETAIL_IMAGES_FILTERING.md) ‚Äî –ü–∞—Ä—Å–∏–Ω–≥ `detail_html`
- [DEBUG_AND_MOCK_MODES.md](DEBUG_AND_MOCK_MODES.md) ‚Äî –†–µ–∂–∏–º—ã –æ—Ç–ª–∞–¥–∫–∏

